(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(3450)}])},3450:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return p}});var a=r(5893),t=r(7294),i=r(7536);let l=r(3454).env.NEXT_PUBLIC_API_URL||"http://localhost:8000";class o extends Error{constructor(e,s,r){super(s),this.name="APIError",this.statusCode=e,this.details=r}}async function d(e,s){try{let r=await fetch(e,s);if(!r.ok){let e={};try{e=await r.json()}catch(s){e={detail:r.statusText}}throw new o(r.status,e.detail||r.statusText||"API error",e)}return r.json()}catch(e){if(e instanceof o)throw e;throw new o(500,e instanceof Error?e.message:"Unknown error",e)}}async function n(e){return d("".concat(l,"/alarms"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}async function m(e){return d("".concat(l,"/assets/").concat(e))}var c=()=>{var e,s,r,l,d;let[c,u]=(0,t.useState)([]),[x,p]=(0,t.useState)(!1),[h,g]=(0,t.useState)(!1),[b,f]=(0,t.useState)("idle"),[v,y]=(0,t.useState)(""),{register:j,handleSubmit:N,watch:w,formState:{errors:_},setValue:k,reset:S}=(0,i.cI)({defaultValues:{asset_class:void 0,asset_symbol:"",alarm_type:void 0,email:"",params:{}}}),A=w("asset_class"),E=w("alarm_type");w("asset_symbol"),(0,t.useEffect)(()=>{A?(p(!0),m(A).then(e=>u(e.assets)).catch(e=>{console.error("Error fetching assets:",e),u([]),y("Failed to load assets")}).finally(()=>p(!1))):u([]),k("asset_symbol","")},[A,k]);let q=async e=>{g(!0),y("");try{var s,r,a,t,i;let l={};if("price"===e.alarm_type){let r=Number(null===(s=e.params)||void 0===s?void 0:s.target_price);if(isNaN(r))throw Error("Invalid target price value");l={target_price:r}}else if("rsi"===e.alarm_type){let s=Number(null===(r=e.params)||void 0===r?void 0:r.period),t=Number(null===(a=e.params)||void 0===a?void 0:a.threshold);if(isNaN(s)||isNaN(t))throw Error("Invalid RSI parameters");l={period:s,threshold:t}}else if("bollinger"===e.alarm_type){let s=Number(null===(t=e.params)||void 0===t?void 0:t.period),r=Number(null===(i=e.params)||void 0===i?void 0:i.std_dev);if(isNaN(s)||isNaN(r))throw Error("Invalid Bollinger parameters");l={period:s,std_dev:r}}let o={...e,params:l};console.log("Sending payload:",o);let d=await n(o);console.log("Server response:",d),f("success"),S()}catch(e){if(console.error("Error submitting alarm:",e),f("error"),e instanceof o)try{let s=JSON.parse(e.message);y(s.detail||"API Error occurred")}catch(s){y(e.message)}else y(e instanceof Error?e.message:"Unknown error occurred")}finally{g(!1)}};return(0,a.jsxs)("form",{onSubmit:N(q),className:"space-y-6 bg-white p-6 rounded-lg shadow",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Asset Class"}),(0,a.jsxs)("select",{...j("asset_class",{required:"Asset class is required"}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[(0,a.jsx)("option",{value:"",children:"Select Asset Class"}),(0,a.jsx)("option",{value:"crypto",children:"Cryptocurrency"}),(0,a.jsx)("option",{value:"forex",children:"Forex"}),(0,a.jsx)("option",{value:"stock",children:"Stock"})]}),_.asset_class&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:_.asset_class.message})]}),A&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Asset Symbol"}),(0,a.jsxs)("select",{...j("asset_symbol",{required:"Asset symbol is required"}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:x,children:[(0,a.jsx)("option",{value:"",children:"Select Asset"}),x?(0,a.jsx)("option",{disabled:!0,children:"Loading assets..."}):c.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]}),_.asset_symbol&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:_.asset_symbol.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Alarm Type"}),(0,a.jsxs)("select",{...j("alarm_type",{required:"Alarm type is required"}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[(0,a.jsx)("option",{value:"",children:"Select Alarm Type"}),(0,a.jsx)("option",{value:"price",children:"Price"}),(0,a.jsx)("option",{value:"rsi",children:"RSI"}),(0,a.jsx)("option",{value:"bollinger",children:"Bollinger Bands"})]}),_.alarm_type&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:_.alarm_type.message})]}),E&&(0,a.jsxs)("div",{className:"space-y-4",children:["price"===E&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Target Price"}),(0,a.jsx)("input",{type:"number",step:"any",...j("params.target_price",{required:"Target price is required",min:{value:0,message:"Price must be positive"}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),(null===(e=_.params)||void 0===e?void 0:e.target_price)&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:_.params.target_price.message})]}),"rsi"===E&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Period"}),(0,a.jsx)("input",{type:"number",...j("params.period",{required:"Period is required",min:{value:1,message:"Period must be positive"}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),(null===(s=_.params)||void 0===s?void 0:s.period)&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:_.params.period.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Threshold"}),(0,a.jsx)("input",{type:"number",...j("params.threshold",{required:"Threshold is required",min:{value:0,message:"Threshold must be between 0 and 100"},max:{value:100,message:"Threshold must be between 0 and 100"}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),(null===(r=_.params)||void 0===r?void 0:r.threshold)&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:_.params.threshold.message})]})]}),"bollinger"===E&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Period"}),(0,a.jsx)("input",{type:"number",...j("params.period",{required:"Period is required",min:{value:1,message:"Period must be positive"}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),(null===(l=_.params)||void 0===l?void 0:l.period)&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:_.params.period.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Standard Deviation"}),(0,a.jsx)("input",{type:"number",step:"0.1",...j("params.std_dev",{required:"Standard deviation is required",min:{value:.1,message:"Standard deviation must be positive"}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),(null===(d=_.params)||void 0===d?void 0:d.std_dev)&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:_.params.std_dev.message})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,a.jsx)("input",{type:"email",...j("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),_.email&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:_.email.message})]}),(0,a.jsx)("button",{type:"submit",disabled:h,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ".concat(h?"bg-indigo-300 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"),children:h?"Setting Alarm...":"Set Alarm"}),v&&(0,a.jsx)("div",{className:"mt-2 text-sm text-red-600",children:v}),"success"===b&&(0,a.jsx)("div",{className:"mt-2 text-sm text-green-600",children:"Alarm set successfully! You will receive an email when the condition is met."})]})},u=r(9008),x=r.n(u),p=()=>(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,a.jsxs)(x(),{children:[(0,a.jsx)("title",{children:"Financial One-shot Alarm System"}),(0,a.jsx)("meta",{name:"description",content:"Set one-time financial alarms"})]}),(0,a.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-center mb-8",children:"Financial One-shot Alarm System"}),(0,a.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,a.jsx)(c,{})})]})]})}},function(e){e.O(0,[494,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);